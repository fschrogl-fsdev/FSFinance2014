<?xml version="1.0" encoding="UTF-8"?>
<beans:beans
  xmlns="http://www.springframework.org/schema/security"
  xmlns:beans="http://www.springframework.org/schema/beans"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.1.xsd
					  http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security-3.2.xsd">

  <http>
	<!-- Protected URLs -->
	<intercept-url pattern="/**/restricted/admin/**" access="ROLE_ADMIN" />
	<intercept-url pattern="/**/restricted/**" access="ROLE_USER" />
		
	<!-- Configure Login Form -->
	<form-login login-page="/pages/login.xhtml"
				default-target-url="/pages/restricted/home.xhtml"
				login-processing-url="${security.loginProcessUrl}"
				authentication-failure-url="/pages/login.xhtml?${security.loginFailureParm}"
				always-use-default-target="false"
				username-parameter="username"
				password-parameter="password" />
					
	<!-- Configure Logout URL -->
	<logout logout-url="/security/logout"/>
  </http>
	
  <authentication-manager>
	<authentication-provider>
	  <user-service>
		<user name="user" password="12init34" authorities="ROLE_USER" />
		<user name="admin" password="12init34" authorities="ROLE_ADMIN,ROLE_USER" />
	  </user-service>
	</authentication-provider>
  </authentication-manager>

  <!-- ============================= -->
  <!-- Spring Security-related Beans -->
  <!-- ============================= -->
  
  <!-- Localization-support for messages issued by Spring Security -->
  <!-- TODO Setup Spring's LocalContextHolder to make this work -->
  <beans:bean id="messageSource" class="org.springframework.context.support.ReloadableResourceBundleMessageSource">
    <beans:property name="basename" value="classpath:org/springframework/security/messages" />
  </beans:bean>

	<beans:bean id="authProvider" class="org.springframework.security.authentication.dao.DaoAuthenticationProvider">
	  <beans:property name="" />
	</beans:bean>

</beans:beans>